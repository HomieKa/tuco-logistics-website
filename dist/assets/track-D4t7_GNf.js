import{d as H,g as p,y as h,h as K,p as Q,i as W,q as U,x as X,c as l,a as t,b as Y,l as i,z as q,A as G,B as J,n as L,t as a,f as Z,e as ee,F as te,r as oe,w as se,T as re,m as le,o as n}from"./index-s4wA7Uap.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={class:"min-h-full bg-[var(--color-tuco-sky)]/20"},ce={class:"mx-auto max-w-7xl px-4 py-8 md:px-6 md:py-12 lg:px-8"},ie={class:"space-y-4"},ue={class:"rounded-2xl border border-[var(--color-tuco-line)] bg-[var(--color-tuco-card)] p-6 shadow-lg/5"},de={class:"space-y-3"},ve={class:"flex items-center gap-3 rounded-xl border border-[var(--color-tuco-line)] bg-white px-4 py-3 shadow-sm focus-within:ring-2 focus-within:ring-[var(--color-tuco-blue)] focus-within:ring-offset-2 focus-within:ring-offset-white"},me={class:"flex flex-wrap items-center gap-4 md:justify-end md:self-center"},fe={key:0,class:"mt-4 rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700"},pe={key:1,class:"mt-4 rounded-xl border border-[var(--color-tuco-line)] bg-[var(--color-tuco-sky)]/40 px-4 py-3 text-sm text-[var(--color-tuco-slate)]"},ge={key:0,class:"mt-10"},be={key:1,class:"mt-10 space-y-10"},xe={class:"rounded-2xl border border-[var(--color-tuco-line)] bg-[var(--color-tuco-card)] p-6 shadow-lg/5"},ye={class:"flex flex-wrap items-center gap-4"},he={class:"mt-6 grid gap-6 sm:grid-cols-2 lg:grid-cols-3"},we={class:"mt-1 text-lg font-semibold text-[var(--color-tuco-navy)]"},_e={class:"mt-1 text-[var(--color-tuco-navy)]"},ke={class:"mt-1 text-[var(--color-tuco-navy)]"},De={class:"mt-1 text-[var(--color-tuco-navy)]"},Te={class:"mt-1 text-[var(--color-tuco-navy)]"},Ce={class:"mt-1 text-[var(--color-tuco-navy)]"},Ee={class:"mt-1 text-[var(--color-tuco-navy)]"},Ne={key:0},Le={class:"text-xs text-[var(--color-tuco-slate)]"},Me={key:1},$e={class:"rounded-2xl border border-[var(--color-tuco-line)] bg-[var(--color-tuco-card)] p-6 shadow-lg/5"},Ie={key:0,class:"mt-6 space-y-6"},Oe={class:"flex flex-col gap-2 rounded-xl border border-[var(--color-tuco-line)] bg-white px-4 py-3 shadow-sm"},Pe={class:"flex flex-wrap items-center gap-2"},Se={class:"text-sm font-semibold text-[var(--color-tuco-navy)]"},Re={key:0,class:"rounded-full bg-[var(--color-tuco-sky)] px-2 py-0.5 text-[10px] font-semibold uppercase tracking-[0.2em] text-[var(--color-tuco-blue)]"},Ue={key:0,class:"text-sm text-[var(--color-tuco-slate)]"},qe={class:"flex flex-wrap items-center gap-2 text-xs text-[var(--color-tuco-slate)]"},Ae=["onClick"],Fe=["src","alt"],Ve={key:1,class:"mt-6 rounded-xl border border-dashed border-[var(--color-tuco-line)] bg-[var(--color-tuco-sky)]/30 px-4 py-3 text-sm text-[var(--color-tuco-slate)]"},je={class:"max-h-full max-w-3xl overflow-hidden rounded-2xl bg-[var(--color-tuco-card)] shadow-2xl focus:outline-none"},Be={class:"flex items-center justify-between border-b border-[var(--color-tuco-line)] px-4 py-3"},ze={class:"text-sm font-semibold text-[var(--color-tuco-navy)]"},He={class:"max-h-[70vh] overflow-auto bg-black"},Ke=["src","alt"],Qe=H({__name:"track",setup(We){const f=Q(),M=X(),u=p(""),r=p(null),v=p(!1),c=p(null),d=p(null),g=h(()=>{var e;return[...((e=r.value)==null?void 0:e.consignmentTracking)??[]].sort((s,y)=>new Date(y.DateTime).getTime()-new Date(s.DateTime).getTime())}),w=h(()=>g.value.length?g.value[0]:null),$=h(()=>{var o;return P((o=r.value)==null?void 0:o.status)}),_=h(()=>{var o;return v.value?{label:"Loading...",className:"bg-amber-50 text-amber-700 ring-amber-200"}:c.value?{label:"Error",className:"bg-rose-50 text-rose-700 ring-rose-200"}:(o=r.value)!=null&&o.status?P(r.value.status):null});let m=null;K(()=>{j();const o=typeof f.query.c=="string"?f.query.c:"";o&&(u.value=o),x(),window.addEventListener("keydown",R)}),W(()=>{k(),window.removeEventListener("keydown",R)}),U(r,()=>{x()}),U(u,()=>{c.value=null});async function A(){const o=u.value.trim().toUpperCase();if(!o){c.value="Please enter a connote number.",r.value=null;return}I(o),await F(o)}async function F(o){k(),v.value=!0,c.value=null,r.value=null,m=new AbortController;try{const e=await fetch(`/api/track/${encodeURIComponent(o)}`,{method:"GET",signal:m.signal});if(!e.ok)throw new Error(e.status===404?"Connote not found.":`Unable to fetch tracking data (HTTP ${e.status}).`);const s=await e.json();r.value=(s==null?void 0:s[0])||null,r.value||(c.value="We couldn't find tracking information for that connote.")}catch(e){if(e.name==="AbortError")return;console.error("Tracking fetch failed",e),c.value=e.message||"We couldn't retrieve tracking data. Please try again."}finally{v.value=!1,m=null,x()}}function k(){m&&(m.abort(),m=null)}function V(){k(),u.value="",r.value=null,c.value=null,I(""),x()}function I(o){const e={...f.query};delete e.demo,o?e.c=o:delete e.c,M.replace({query:e}).catch(()=>{})}function j(){if("demo"in f.query){const o={...f.query};delete o.demo,M.replace({query:o}).catch(()=>{})}}function b(o){if(!o)return"-";try{const e=new Date(o);return new Intl.DateTimeFormat(void 0,{dateStyle:"medium",timeStyle:"short"}).format(e)}catch{return o}}function O(o){if(!o)return"unknown time";const e=Date.now(),s=new Date(o).getTime(),y=e-s,C=Math.round(y/1e3);if(C<60)return`${C}s ago`;const E=Math.round(C/60);if(E<60)return`${E}m ago`;const N=Math.round(E/60);return N<24?`${N}h ago`:`${Math.round(N/24)}d ago`}function P(o){const e=(o==null?void 0:o.toUpperCase())||"",s="ring-1";return e==="DELIVERED"?{label:"Delivered",className:`${s} bg-green-50 text-green-700 ring-green-200`}:e==="OUT_FOR_DELIVERY"?{label:"Out for delivery",className:`${s} bg-amber-50 text-amber-700 ring-amber-200`}:["PICKED_UP","IN_TRANSIT","MANIFESTED"].includes(e)?{label:D(e.replace(/_/g," ")),className:`${s} bg-blue-50 text-blue-700 ring-blue-200`}:["EXCEPTION","ON_HOLD"].includes(e)?{label:D(e.replace(/_/g," ")),className:`${s} bg-rose-50 text-rose-700 ring-rose-200`}:e?{label:D(e.replace(/_/g," ")),className:`${s} bg-slate-100 text-slate-700 ring-slate-200`}:{label:"Status pending",className:`${s} bg-slate-100 text-slate-700 ring-slate-200`}}function B(o){const e=o==null?void 0:o.toUpperCase();return e==="DELIVERED"?"bg-green-500 ring-green-200":e==="OUT_FOR_DELIVERY"?"bg-amber-500 ring-amber-200":["PICKED_UP","IN_TRANSIT","MANIFESTED"].includes(e||"")?"bg-blue-500 ring-blue-200":["EXCEPTION","ON_HOLD"].includes(e||"")?"bg-rose-500 ring-rose-200":"bg-slate-400 ring-slate-200"}function D(o){return o.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function S(o){return o&&[o.name,o.state,o.postcode].filter(Boolean).join(", ")||"-"}function z(o,e){d.value={src:o,alt:e},le(()=>{const s=document.querySelector('[role="dialog"]');s==null||s.focus()})}function T(){d.value=null}function R(o){o.key==="Escape"&&d.value&&T()}function x(){var e;const o="Freight Tracking | TUCO";if((e=r.value)!=null&&e.ConnoteNumber){document.title=`${o} - ${r.value.ConnoteNumber}`;return}document.title=o}return(o,e)=>(n(),l("div",ne,[t("div",ce,[t("header",ie,[e[4]||(e[4]=t("div",null,[t("p",{class:"text-sm font-semibold uppercase tracking-[0.3em] text-[var(--color-tuco-blue)]"},"Tracking"),t("h1",{class:"text-4xl font-semibold text-[var(--color-tuco-navy)] md:text-5xl"},"Freight tracking"),t("p",{class:"mt-2 text-[var(--color-tuco-slate)] md:text-lg"},"Live shipment status and milestone history for your consignments.")],-1)),t("div",ue,[t("form",{onSubmit:q(A,["prevent"]),class:"grid gap-4 md:grid-cols-[1fr_auto] md:items-center"},[t("div",de,[e[2]||(e[2]=t("label",{class:"text-xs font-semibold uppercase tracking-widest text-[var(--color-tuco-blue)]",for:"connote-input"}," Enter connote number ",-1)),t("div",ve,[G(t("input",{id:"connote-input","onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),type:"text",inputmode:"text",autocomplete:"off",class:"h-full flex-1 border-none bg-transparent text-base text-[var(--color-tuco-navy)] outline-none md:text-lg",placeholder:"Enter connote number"},null,512),[[J,u.value]]),u.value?(n(),l("button",{key:0,type:"button",onClick:V,class:"rounded-full p-1 text-[var(--color-tuco-slate)] transition hover:bg-[var(--color-tuco-sky)]/60 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--color-tuco-blue)] focus-visible:ring-offset-2","aria-label":"Clear connote number"},[...e[1]||(e[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])):i("",!0)])]),t("div",me,[_.value?(n(),l("div",{key:0,class:L(["rounded-full px-3 py-1 text-xs font-semibold ring-1",_.value.className]),role:"status"},a(_.value.label),3)):i("",!0),e[3]||(e[3]=t("button",{type:"submit",class:"btn-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--color-tuco-blue)] focus-visible:ring-offset-2"}," Track shipment ",-1))])],32),c.value?(n(),l("div",fe,a(c.value),1)):!r.value&&!v.value?(n(),l("div",pe," Enter a connote to view live tracking updates. ")):i("",!0)])]),v.value?(n(),l("section",ge,[...e[5]||(e[5]=[Z('<div class="rounded-2xl border border-[var(--color-tuco-line)] bg-[var(--color-tuco-card)] p-6 shadow-lg/5" data-v-542cf533><div class="flex items-center gap-3 text-[var(--color-tuco-slate)]" data-v-542cf533><svg class="h-5 w-5 animate-spin text-[var(--color-tuco-blue)]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-542cf533><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-542cf533></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-542cf533></path></svg> Fetching latest tracking updates... </div></div>',1)])])):i("",!0),r.value&&!v.value?(n(),l("section",be,[t("div",xe,[t("div",ye,[t("span",{class:L(["rounded-full px-3 py-1 text-xs font-semibold ring-1",$.value.className])},a($.value.label),3)]),t("dl",he,[t("div",null,[e[6]||(e[6]=t("dt",{class:"text-xs font-semibold uppercase tracking-widest text-[var(--color-tuco-slate)]"},"Connote",-1)),t("dd",we,a(r.value.ConnoteNumber),1)]),t("div",null,[t("dd",_e,a(r.value.carrierDisplayName||"-"),1),t("dd",ke,a(r.value.carrierDisplayName||"-"),1)]),t("div",null,[e[7]||(e[7]=t("dt",{class:"text-xs font-semibold uppercase tracking-widest text-[var(--color-tuco-slate)]"},"Service",-1)),t("dd",De,a(r.value.serviceType||"-"),1)]),t("div",null,[e[8]||(e[8]=t("dt",{class:"text-xs font-semibold uppercase tracking-widest text-[var(--color-tuco-slate)]"},"From",-1)),t("dd",Te,a(S(r.value.senderAddressSuburb)),1)]),t("div",null,[e[9]||(e[9]=t("dt",{class:"text-xs font-semibold uppercase tracking-widest text-[var(--color-tuco-slate)]"},"To",-1)),t("dd",Ce,a(S(r.value.deliveryAddressSuburb)),1)]),t("div",null,[e[10]||(e[10]=t("dt",{class:"text-xs font-semibold uppercase tracking-widest text-[var(--color-tuco-slate)]"},"Last update",-1)),t("dd",Ee,[w.value?(n(),l("span",Ne,[ee(a(b(w.value.DateTime))+" ",1),t("span",Le,"("+a(O(w.value.DateTime))+")",1)])):(n(),l("span",Me,"-"))])])])]),t("section",$e,[e[13]||(e[13]=t("h2",{class:"text-xl font-semibold text-[var(--color-tuco-navy)]"},"Tracking timeline",-1)),e[14]||(e[14]=t("p",{class:"mt-1 text-sm text-[var(--color-tuco-slate)]"},"Reverse chronological view of each milestone.",-1)),g.value.length?(n(),l("ol",Ie,[(n(!0),l(te,null,oe(g.value,s=>(n(),l("li",{key:s.DateTime+s.Status,class:"relative pl-6"},[t("span",{class:L(["absolute left-0 top-1 h-3 w-3 rounded-full ring-4",B(s.UpdateStatus)])},null,2),t("div",Oe,[t("div",Pe,[t("p",Se,a(s.Status),1),s.Location?(n(),l("span",Re,a(s.Location),1)):i("",!0)]),s.StatusDescription?(n(),l("p",Ue,a(s.StatusDescription),1)):i("",!0),t("div",qe,[t("span",null,a(b(s.DateTime)),1),e[11]||(e[11]=t("span",null,"Â·",-1)),t("span",null,a(O(s.DateTime)),1)]),s.POD?(n(),l("button",{key:1,type:"button",class:"group relative mt-1 flex items-center gap-3",onClick:y=>z(s.POD,`POD - ${s.Status} - ${b(s.DateTime)}`)},[t("img",{src:s.POD,alt:`POD - ${s.Status} - ${b(s.DateTime)}`,class:"h-20 w-24 rounded-lg border border-[var(--color-tuco-line)] object-cover transition group-hover:-translate-y-0.5 group-hover:shadow-lg",referrerpolicy:"no-referrer"},null,8,Fe),e[12]||(e[12]=t("span",{class:"text-xs font-semibold text-[var(--color-tuco-blue)]"},"View proof",-1))],8,Ae)):i("",!0)])]))),128))])):(n(),l("p",Ve," No tracking events yet. "))])])):i("",!0)]),Y(re,{name:"fade"},{default:se(()=>[d.value?(n(),l("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-6",role:"dialog","aria-modal":"true",tabindex:"-1",onClick:q(T,["self"])},[t("div",je,[t("header",Be,[t("h3",ze,a(d.value.alt),1),t("button",{type:"button",onClick:T,class:"rounded-full p-2 text-[var(--color-tuco-slate)] transition hover:bg-[var(--color-tuco-sky)]/60 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--color-tuco-blue)] focus-visible:ring-offset-2","aria-label":"Close proof image"},[...e[15]||(e[15]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",He,[t("img",{src:d.value.src,alt:d.value.alt,class:"block max-h-[70vh] w-full object-contain",referrerpolicy:"no-referrer"},null,8,Ke)])])])):i("",!0)]),_:1})]))}}),Je=ae(Qe,[["__scopeId","data-v-542cf533"]]);export{Je as default};
